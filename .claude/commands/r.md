# エラー解決6段階プロトコル

エラーが発生した場合の体系的な解決プロセスを実行します。

## 使用方法
```
/r エラー内容
```

例:
- `/r TypeError: Cannot read property 'bold' of undefined`
- `/r ENOENT: no such file or directory`
- `/r Delete ␍`

## 6段階プロトコルの自動実行

**実行前チェックリスト**:
1. ✅ CLAUDE.mdのエラーパターンデータベースを確認
2. ✅ 既知のエラーなら、そこに書かれた解決方法を適用
3. ✅ 新規エラーなら、以下の6段階を実行
4. ✅ 解決後は必ずCLAUDE.mdに追記

### 🔍 ステップ1: 調査フェーズ
- エラーメッセージの完全な収集
- スタックトレースの分析
- 関連ファイルの特定
- エラー発生コンテキストの理解

### 🧠 ステップ2: 分析フェーズ
- エラーの根本原因特定
- `.claude/CLAUDE.md`の過去のエラーパターン確認
- `.claude/error-templates.json`の既知の解決策チェック
- 類似エラーの検索

### 📋 ステップ3: 計画フェーズ
- 解決戦略の立案
- 必要な変更箇所のリストアップ
- 副作用のリスク評価
- 実行順序の決定

### 🔧 ステップ4: 対処フェーズ
- 計画に基づいた修正の実施
- 関連する全ファイルへの変更適用
- 一貫性の確保
- 適切なエラーハンドリングの実装

### 🧪 ステップ5: テストフェーズ
- 修正の動作確認
- 関連テストの実行
- リグレッションチェック
- CI/CDパイプラインでの検証

### 📚 ステップ6: 学習フェーズ
- 解決策を`.claude/CLAUDE.md`に記録
- `.claude/error-templates.json`に新パターン追加
- チームへの知識共有
- 再発防止策の実装

**重要: 必ず以下の形式でCLAUDE.mdのエラーパターンデータベースに追記すること**

```markdown
### [エラーカテゴリ名]
| エラーパターン | 原因 | 解決方法 |
|------------|------|---------|
| `具体的なエラーメッセージ` | なぜ起きたか | どう直したか |
```

例:
```markdown
### ESLint/Prettierエラー
| エラーパターン | 原因 | 解決方法 |
|------------|------|---------|
| `'options' is defined but never used` | 未使用変数 | 変数名の前に_を付ける（例: options → _options） |
```

## 自動化された処理

1. **エラーパターン認識**: 引数として渡されたエラーを分析
2. **既知の解決策適用**: データベースから最適な解決策を選択
3. **新規エラー対応**: 未知のエラーは6段階プロトコルで対処
4. **継続的学習**: 新しい解決策を自動的にデータベースに追加

## 出力例
```
🔍 調査フェーズ開始...
  → TypeError in logger.test.ts:45
  → chalk.redBright.boldが未定義

🧠 分析フェーズ開始...
  → chalkモックの不完全な実装が原因
  → メソッドチェーンがサポートされていない

📋 計画フェーズ開始...
  → チェーン可能なモック関数の作成
  → 全colorメソッドへの適用

🔧 対処フェーズ開始...
  → tests/unit/lib/logger.test.ts を修正
  → createChainableMock関数を実装

🧪 テストフェーズ開始...
  → npm test実行... ✅ 成功

📚 学習フェーズ開始...
  → 解決策をCLAUDE.mdに記録
  → エラーテンプレートを更新
```

## 重要事項
- エラー引数は`$ARGUMENTS`として渡される
- 自動的に関連ファイルを検索・修正
- 必ずgit commitとpushを実行
- 解決策は永続的にデータベース化される